# ============================================
# VulnZero Environment Configuration
# ============================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control!

# ============================================
# Application Settings
# ============================================
APP_NAME=VulnZero
APP_ENV=development  # development, staging, production
DEBUG=true
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# ============================================
# Database Configuration
# ============================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=vulnzero
POSTGRES_USER=vulnzero_user
POSTGRES_PASSWORD=change_me_in_production

# Database URL (alternative to individual settings)
DATABASE_URL=postgresql://vulnzero_user:change_me_in_production@localhost:5432/vulnzero

# ============================================
# Redis Configuration
# ============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis URL (alternative to individual settings)
REDIS_URL=redis://localhost:6379/0

# ============================================
# Celery Configuration
# ============================================
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/1
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC

# ============================================
# API Gateway Settings
# ============================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_RELOAD=true  # Auto-reload on code changes (dev only)

# CORS Settings
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true

# ============================================
# JWT Authentication
# ============================================
JWT_SECRET_KEY=generate_a_secure_random_key_here_minimum_32_characters
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# ============================================
# LLM Configuration (AI Patch Generation)
# ============================================
# Choose one: openai or anthropic
LLM_PROVIDER=openai  # openai, anthropic

# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4  # gpt-4, gpt-3.5-turbo
OPENAI_MAX_TOKENS=2000
OPENAI_TEMPERATURE=0.2

# Anthropic Configuration
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-5-sonnet-20250129
ANTHROPIC_MAX_TOKENS=2000
ANTHROPIC_TEMPERATURE=0.2

# ============================================
# Vulnerability Scanner Integrations
# ============================================

# Wazuh
WAZUH_API_URL=https://your-wazuh-instance.com:55000
WAZUH_USERNAME=wazuh-api-user
WAZUH_PASSWORD=wazuh-api-password

# Qualys
QUALYS_API_URL=https://qualysapi.qualys.com
QUALYS_USERNAME=your-qualys-username
QUALYS_PASSWORD=your-qualys-password

# Tenable.io
TENABLE_ACCESS_KEY=your-tenable-access-key
TENABLE_SECRET_KEY=your-tenable-secret-key

# ============================================
# External API Keys
# ============================================
# NVD (National Vulnerability Database)
NVD_API_KEY=your-nvd-api-key  # Get from https://nvd.nist.gov/developers/request-an-api-key

# ============================================
# Docker Configuration
# ============================================
DOCKER_HOST=unix:///var/run/docker.sock
DOCKER_REGISTRY=docker.io
DOCKER_REGISTRY_USERNAME=
DOCKER_REGISTRY_PASSWORD=

# ============================================
# Kubernetes Configuration (if using K8s)
# ============================================
KUBERNETES_ENABLED=false
KUBECONFIG_PATH=/home/user/.kube/config
KUBERNETES_NAMESPACE=vulnzero

# ============================================
# Ansible Configuration
# ============================================
ANSIBLE_HOST_KEY_CHECKING=false
ANSIBLE_PRIVATE_KEY_PATH=/path/to/ssh/private/key
ANSIBLE_REMOTE_USER=ansible
ANSIBLE_BECOME=true
ANSIBLE_BECOME_METHOD=sudo

# ============================================
# Monitoring & Observability
# ============================================
# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_ENABLED=true
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_me_in_production

# Sentry (Error Tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# Notification Settings
# ============================================
# Email
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@example.com
SMTP_PASSWORD=your-email-password
SMTP_FROM_EMAIL=noreply@vulnzero.io
SMTP_USE_TLS=true

# Slack
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#security-alerts

# PagerDuty
PAGERDUTY_API_KEY=
PAGERDUTY_SERVICE_ID=

# ============================================
# Cloud Provider Configuration
# ============================================
# AWS
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET=vulnzero-artifacts

# Azure (if applicable)
AZURE_SUBSCRIPTION_ID=
AZURE_TENANT_ID=
AZURE_CLIENT_ID=
AZURE_CLIENT_SECRET=

# GCP (if applicable)
GCP_PROJECT_ID=
GCP_SERVICE_ACCOUNT_KEY_PATH=/path/to/service-account-key.json

# ============================================
# Security Settings
# ============================================
# Secrets Manager
SECRETS_MANAGER=env  # env, aws_secrets_manager, hashicorp_vault

# HashiCorp Vault
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=your-vault-token

# AWS Secrets Manager
AWS_SECRETS_REGION=us-east-1

# ============================================
# Feature Flags
# ============================================
FEATURE_AUTO_REMEDIATION=false  # Enable automatic remediation (no manual approval)
FEATURE_ML_PRIORITIZATION=false  # Enable ML-based vulnerability prioritization
FEATURE_MULTI_CLOUD=false  # Enable multi-cloud deployment support
FEATURE_ROLLBACK=true  # Enable automatic rollback on anomaly detection

# ============================================
# Rate Limiting
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# ============================================
# Testing & Development
# ============================================
# Test Database (separate from main DB)
TEST_DATABASE_URL=postgresql://vulnzero_user:change_me_in_production@localhost:5432/vulnzero_test

# Fixture Data
LOAD_FIXTURES=true  # Load sample data on startup (dev only)

# ============================================
# Deployment Settings
# ============================================
DEPLOYMENT_MODE=manual  # manual, semi_auto, full_auto
DEPLOYMENT_STRATEGY=canary  # blue_green, canary, rolling, all_at_once
ROLLBACK_ON_ANOMALY=true
MONITORING_WINDOW_MINUTES=15

# Maintenance Windows (comma-separated, UTC)
# Format: DAY:START_TIME-END_TIME
# Example: MON:02:00-04:00,SAT:00:00-06:00
MAINTENANCE_WINDOWS=

# ============================================
# Performance Settings
# ============================================
MAX_CONCURRENT_SCANS=5
MAX_CONCURRENT_DEPLOYMENTS=3
MAX_CONCURRENT_TESTS=10
TASK_TIMEOUT_SECONDS=300

# Cache TTL (seconds)
CACHE_TTL_VULNERABILITIES=300
CACHE_TTL_ASSETS=600
CACHE_TTL_NVD_DATA=86400  # 24 hours

# ============================================
# Web Dashboard (Frontend)
# ============================================
REACT_APP_API_URL=http://localhost:8000
REACT_APP_WS_URL=ws://localhost:8000
REACT_APP_ENV=development
