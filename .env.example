# ==============================================
# VulnZero Configuration
# ==============================================

# Application Environment
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO

# API Configuration
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_SECRET_KEY=your-secret-key-change-this-in-production
API_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS Settings
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true

# Database Configuration
DATABASE_URL=postgresql+asyncpg://vulnzero:vulnzero_password@localhost:5432/vulnzero
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_ECHO=false

# Redis Configuration
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=50

# Celery Configuration
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_TIME_LIMIT=3600
CELERY_TASK_SOFT_TIME_LIMIT=3300

# AI/LLM Configuration
# OpenAI
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.2

# Anthropic Claude
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key
ANTHROPIC_MODEL=claude-3-sonnet-20240229
ANTHROPIC_MAX_TOKENS=4096

# LLM Provider (openai or anthropic)
LLM_PROVIDER=openai

# Vulnerability Scanner Integrations
# Wazuh
WAZUH_API_URL=https://wazuh.example.com:55000
WAZUH_API_USER=wazuh-api-user
WAZUH_API_PASSWORD=wazuh-api-password
WAZUH_VERIFY_SSL=true

# Qualys
QUALYS_API_URL=https://qualysapi.qualys.com
QUALYS_USERNAME=qualys-username
QUALYS_PASSWORD=qualys-password

# Tenable.io
TENABLE_ACCESS_KEY=your-tenable-access-key
TENABLE_SECRET_KEY=your-tenable-secret-key

# NVD (National Vulnerability Database)
NVD_API_KEY=your-nvd-api-key
NVD_API_URL=https://services.nvd.nist.gov/rest/json/cves/2.0

# EPSS (Exploit Prediction Scoring System)
EPSS_API_URL=https://api.first.org/data/v1/epss

# Docker Configuration
DOCKER_HOST=unix:///var/run/docker.sock
DOCKER_API_VERSION=auto
DOCKER_TIMEOUT=300

# Kubernetes Configuration (if using K8s instead of Docker)
KUBERNETES_CONFIG_PATH=~/.kube/config
KUBERNETES_NAMESPACE=vulnzero

# Ansible Configuration
ANSIBLE_PRIVATE_KEY_PATH=/etc/vulnzero/keys/ansible_key
ANSIBLE_HOST_KEY_CHECKING=false
ANSIBLE_TIMEOUT=300

# Terraform Configuration
TERRAFORM_BINARY_PATH=/usr/local/bin/terraform
TERRAFORM_WORKSPACE_DIR=/var/lib/vulnzero/terraform

# AWS Configuration (if using AWS)
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=vulnzero-artifacts

# Monitoring & Observability
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus_multiproc
PROMETHEUS_PORT=9090
GRAFANA_URL=http://localhost:3001
GRAFANA_API_KEY=your-grafana-api-key

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=vulnzero
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp

# Alerting & Notifications
# Slack
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#vulnzero-alerts

# Email (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=alerts@vulnzero.io
SMTP_PASSWORD=your-email-password
SMTP_FROM=alerts@vulnzero.io
SMTP_TLS=true

# PagerDuty
PAGERDUTY_API_KEY=your-pagerduty-api-key
PAGERDUTY_SERVICE_ID=your-service-id

# Security Settings
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0
TRUSTED_PROXIES=127.0.0.1

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# Deployment Settings
DEPLOYMENT_STRATEGY=canary  # Options: blue-green, canary, rolling, all-at-once
DEPLOYMENT_HEALTH_CHECK_TIMEOUT=300
DEPLOYMENT_ROLLBACK_ENABLED=true
DEPLOYMENT_MAX_PARALLEL=10

# Digital Twin Testing
TESTING_TIMEOUT=600
TESTING_PARALLEL_LIMIT=5
TESTING_CONTAINER_CPU_LIMIT=2
TESTING_CONTAINER_MEMORY_LIMIT=4g

# Patch Generation Settings
PATCH_CONFIDENCE_THRESHOLD=0.8
PATCH_VALIDATION_ENABLED=true
PATCH_CACHE_TTL=86400  # 24 hours in seconds

# Monitoring & Rollback
MONITORING_WINDOW_SECONDS=900  # 15 minutes
ANOMALY_DETECTION_THRESHOLD=2.0  # Z-score threshold
AUTO_ROLLBACK_ENABLED=true
ROLLBACK_ON_ERROR_RATE_INCREASE=0.5  # 50% increase

# Scanning Settings
SCAN_INTERVAL_HOURS=6
SCAN_TIMEOUT=3600
VULNERABILITY_CACHE_TTL=3600

# Audit & Compliance
AUDIT_LOG_RETENTION_DAYS=90
ENABLE_AUDIT_LOGGING=true
AUDIT_LOG_PATH=/var/log/vulnzero/audit.log

# Feature Flags
FEATURE_AUTO_REMEDIATION=true
FEATURE_MANUAL_APPROVAL_REQUIRED=false
FEATURE_CRITICAL_VULN_AUTO_APPROVE=true
FEATURE_ML_PRIORITIZATION=true

# Development/Testing
ENABLE_SWAGGER_UI=true
ENABLE_REDOC=true
MOCK_SCANNER_APIS=false
MOCK_LLM_APIS=false
