# ============================================================================
# VulnZero Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env file to version control!

# ============================================================================
# Application Settings
# ============================================================================
APP_NAME=VulnZero
ENVIRONMENT=development  # development, staging, production
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
DEBUG=True

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
DATABASE_NAME=vulnzero
DATABASE_USER=vulnzero
DATABASE_PASSWORD=vulnzero_dev_password_change_me
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_URL=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}

# Database Pool Settings
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_TIMEOUT=30

# ============================================================================
# Redis Configuration (Cache & Message Broker)
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=vulnzero_redis_password_change_me
REDIS_DB=0
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis Cache TTL (seconds)
CACHE_TTL_SHORT=300      # 5 minutes
CACHE_TTL_MEDIUM=3600    # 1 hour
CACHE_TTL_LONG=86400     # 24 hours

# ============================================================================
# Celery Configuration (Async Tasks)
# ============================================================================
CELERY_BROKER_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0
CELERY_RESULT_BACKEND=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/1
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=True
CELERY_TASK_TRACK_STARTED=True
CELERY_TASK_TIME_LIMIT=3600  # 1 hour max per task
CELERY_WORKER_CONCURRENCY=4

# ============================================================================
# JWT Authentication
# ============================================================================
JWT_SECRET_KEY=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================================================
# AI/LLM Configuration
# ============================================================================

# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4  # gpt-4, gpt-4-turbo-preview, gpt-3.5-turbo
OPENAI_MAX_TOKENS=2000
OPENAI_TEMPERATURE=0.3
OPENAI_TIMEOUT=60

# Anthropic Claude Configuration
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-sonnet-20240229  # claude-3-opus, claude-3-sonnet, claude-3-haiku
ANTHROPIC_MAX_TOKENS=2000
ANTHROPIC_TEMPERATURE=0.3

# LLM Provider Selection
LLM_PROVIDER=openai  # openai, anthropic
LLM_FALLBACK_ENABLED=True
LLM_MAX_RETRIES=3
LLM_RETRY_DELAY=2

# ============================================================================
# Vulnerability Scanner Integration
# ============================================================================

# Wazuh Configuration
WAZUH_API_URL=https://wazuh.example.com:55000
WAZUH_API_USERNAME=wazuh-admin
WAZUH_API_PASSWORD=your-wazuh-password
WAZUH_VERIFY_SSL=True
WAZUH_TIMEOUT=30

# Qualys Configuration
QUALYS_API_URL=https://qualysapi.qualys.com
QUALYS_USERNAME=your-qualys-username
QUALYS_PASSWORD=your-qualys-password
QUALYS_TIMEOUT=60

# Tenable.io Configuration
TENABLE_ACCESS_KEY=your-tenable-access-key
TENABLE_SECRET_KEY=your-tenable-secret-key
TENABLE_TIMEOUT=60

# NVD (National Vulnerability Database) API
NVD_API_KEY=your-nvd-api-key-here
NVD_API_URL=https://services.nvd.nist.gov/rest/json/cves/2.0
NVD_RATE_LIMIT=5  # requests per second

# ============================================================================
# Monitoring & Metrics
# ============================================================================

# Prometheus
PROMETHEUS_PORT=9090
PROMETHEUS_METRICS_PATH=/metrics

# Grafana
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin_change_me
GRAFANA_PORT=3001

# Sentry (Error Tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=${ENVIRONMENT}
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# Notifications
# ============================================================================
# ==============================================
# VulnZero Configuration
# ==============================================

# Application Environment

# API Configuration
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_SECRET_KEY=your-secret-key-change-this-in-production
API_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS Settings
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true

# Database Configuration
DATABASE_ECHO=false

# Redis Configuration
REDIS_MAX_CONNECTIONS=50

# Celery Configuration
CELERY_TASK_SOFT_TIME_LIMIT=3300

# AI/LLM Configuration
# OpenAI

# Anthropic Claude

# LLM Provider (openai or anthropic)

# Vulnerability Scanner Integrations
# Wazuh
WAZUH_API_USER=wazuh-api-user

# Qualys

# Tenable.io

# NVD (National Vulnerability Database)

# EPSS (Exploit Prediction Scoring System)
EPSS_API_URL=https://api.first.org/data/v1/epss

# Docker Configuration
DOCKER_HOST=unix:///var/run/docker.sock
DOCKER_API_VERSION=auto
DOCKER_TIMEOUT=300

# Kubernetes Configuration (if using K8s instead of Docker)
KUBERNETES_CONFIG_PATH=~/.kube/config
KUBERNETES_NAMESPACE=vulnzero

# Ansible Configuration
ANSIBLE_PRIVATE_KEY_PATH=/etc/vulnzero/keys/ansible_key
ANSIBLE_HOST_KEY_CHECKING=false
ANSIBLE_TIMEOUT=300

# Terraform Configuration
TERRAFORM_BINARY_PATH=/usr/local/bin/terraform
TERRAFORM_WORKSPACE_DIR=/var/lib/vulnzero/terraform

# AWS Configuration (if using AWS)
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=vulnzero-artifacts

# Monitoring & Observability
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus_multiproc
GRAFANA_URL=http://localhost:3001
GRAFANA_API_KEY=your-grafana-api-key

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=vulnzero
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp

# Alerting & Notifications
# Slack
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#vulnzero-alerts

# Email (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@example.com
SMTP_PASSWORD=your-email-password
SMTP_FROM_EMAIL=noreply@vulnzero.com
SMTP_FROM_NAME=VulnZero
SMTP_USE_TLS=True

# Slack Integration
SLACK_USERNAME=VulnZero Bot
SLACK_ICON_EMOJI=:robot_face:

# PagerDuty
PAGERDUTY_API_KEY=your-pagerduty-api-key
PAGERDUTY_INTEGRATION_KEY=your-integration-key

# ============================================================================
# Docker Configuration
# ============================================================================
DOCKER_REGISTRY=docker.io
DOCKER_REGISTRY_USERNAME=your-docker-username
DOCKER_REGISTRY_PASSWORD=your-docker-password

# Digital Twin Settings
DIGITAL_TWIN_CPU_LIMIT=2
DIGITAL_TWIN_MEMORY_LIMIT=4g
DIGITAL_TWIN_TIMEOUT=600  # 10 minutes
DIGITAL_TWIN_NETWORK_ISOLATED=True

# ============================================================================
# Ansible Configuration
# ============================================================================
ANSIBLE_INVENTORY_PATH=/etc/ansible/hosts
ANSIBLE_REMOTE_USER=ansible
ANSIBLE_FORKS=5

# ============================================================================
# Deployment Configuration
# ============================================================================

# Deployment Settings
DEPLOYMENT_STRATEGY=blue-green  # blue-green, canary, rolling, all-at-once
DEPLOYMENT_TIMEOUT=1800  # 30 minutes
DEPLOYMENT_ROLLBACK_ENABLED=True
DEPLOYMENT_APPROVAL_REQUIRED=False  # Require manual approval for deployments

# Canary Deployment Settings
CANARY_INITIAL_PERCENTAGE=10
CANARY_INCREMENT=40
CANARY_WAIT_TIME=900  # 15 minutes between increments

# ============================================================================
# Security Settings
# ============================================================================

# API Rate Limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# CORS Settings
CORS_CREDENTIALS=True
CORS_METHODS=GET,POST,PUT,DELETE,PATCH
CORS_HEADERS=*

# Session Settings
SESSION_SECRET_KEY=your-session-secret-key-change-in-production
SESSION_COOKIE_SECURE=False  # Set to True in production (HTTPS only)
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=lax

# Password Policy
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=True
PASSWORD_REQUIRE_LOWERCASE=True
PASSWORD_REQUIRE_NUMBERS=True
PASSWORD_REQUIRE_SPECIAL=True

# ============================================================================
# Secrets Management
# ============================================================================

# AWS Secrets Manager (Optional)
AWS_SECRETS_MANAGER_ENABLED=False

# HashiCorp Vault (Optional)
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=your-vault-token
VAULT_ENABLED=False

# ============================================================================
# Machine Learning Configuration
# ============================================================================

# Vulnerability Prioritization Model
ML_MODEL_PATH=/app/models/prioritization_model.pkl
ML_FEATURE_COLUMNS=cvss_score,epss_score,age_days,exploit_available,asset_criticality
ML_TRAINING_ENABLED=False
ML_RETRAINING_INTERVAL_DAYS=7

# ============================================================================
# Feature Flags
# ============================================================================
FEATURE_AUTO_REMEDIATION=True
FEATURE_DIGITAL_TWIN_TESTING=True
FEATURE_CANARY_DEPLOYMENTS=True
FEATURE_ML_PRIORITIZATION=True
FEATURE_SLACK_NOTIFICATIONS=True
FEATURE_EMAIL_NOTIFICATIONS=True
FEATURE_AUDIT_LOGGING=True

# ============================================================================
# Development Tools (Only for Development)
# ============================================================================

# pgAdmin
PGADMIN_EMAIL=admin@vulnzero.local
PGADMIN_PASSWORD=admin

# Flower (Celery Monitoring)
FLOWER_PORT=5555
FLOWER_BASIC_AUTH=admin:admin

# ============================================================================
# Cloud Provider Configuration (Optional)
# ============================================================================

# AWS
AWS_ACCOUNT_ID=your-aws-account-id
AWS_DEFAULT_REGION=us-east-1
AWS_ECR_REGISTRY=your-account-id.dkr.ecr.us-east-1.amazonaws.com

# Azure (Optional)
AZURE_SUBSCRIPTION_ID=your-subscription-id
AZURE_TENANT_ID=your-tenant-id
AZURE_CLIENT_ID=your-client-id
AZURE_CLIENT_SECRET=your-client-secret

# GCP (Optional)
GCP_PROJECT_ID=your-project-id
GCP_CREDENTIALS_PATH=/path/to/credentials.json

# ============================================================================
# Backup & Disaster Recovery
# ============================================================================
BACKUP_ENABLED=True
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM (cron format)
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=vulnzero-backups

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_FORMAT=json  # json, text
LOG_FILE_PATH=/app/logs/vulnzero.log
LOG_FILE_MAX_SIZE=100MB
LOG_FILE_BACKUP_COUNT=10
LOG_TO_FILE=True
LOG_TO_CONSOLE=True

# ============================================================================
# Testing Configuration
# ============================================================================
TEST_DATABASE_URL=postgresql://vulnzero:vulnzero_test@localhost:5432/vulnzero_test
TEST_REDIS_URL=redis://localhost:6379/15
PYTEST_WORKERS=auto
COVERAGE_THRESHOLD=80

# ============================================================================
# API Documentation
# ============================================================================
API_DOCS_ENABLED=True
API_DOCS_PATH=/docs
API_REDOC_PATH=/redoc
API_OPENAPI_PATH=/openapi.json

# ============================================================================
# Miscellaneous
# ============================================================================
TIMEZONE=UTC
LANGUAGE=en
CURRENCY=USD
MAX_UPLOAD_SIZE=10485760  # 10 MB
TEMP_DIR=/tmp/vulnzero
SMTP_USER=alerts@vulnzero.io
SMTP_FROM=alerts@vulnzero.io
SMTP_TLS=true

# PagerDuty
PAGERDUTY_SERVICE_ID=your-service-id

# Security Settings
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0
TRUSTED_PROXIES=127.0.0.1

# Rate Limiting
RATE_LIMIT_PER_HOUR=1000

# Deployment Settings
DEPLOYMENT_HEALTH_CHECK_TIMEOUT=300
DEPLOYMENT_MAX_PARALLEL=10

# Digital Twin Testing
TESTING_TIMEOUT=600
TESTING_PARALLEL_LIMIT=5
TESTING_CONTAINER_CPU_LIMIT=2
TESTING_CONTAINER_MEMORY_LIMIT=4g

# Patch Generation Settings
PATCH_CONFIDENCE_THRESHOLD=0.8
PATCH_VALIDATION_ENABLED=true
PATCH_CACHE_TTL=86400  # 24 hours in seconds

# Monitoring & Rollback
MONITORING_WINDOW_SECONDS=900  # 15 minutes
ANOMALY_DETECTION_THRESHOLD=2.0  # Z-score threshold
AUTO_ROLLBACK_ENABLED=true
ROLLBACK_ON_ERROR_RATE_INCREASE=0.5  # 50% increase

# Scanning Settings
SCAN_INTERVAL_HOURS=6
SCAN_TIMEOUT=3600
VULNERABILITY_CACHE_TTL=3600

# Audit & Compliance
AUDIT_LOG_RETENTION_DAYS=90
ENABLE_AUDIT_LOGGING=true
AUDIT_LOG_PATH=/var/log/vulnzero/audit.log

# Feature Flags
FEATURE_MANUAL_APPROVAL_REQUIRED=false
FEATURE_CRITICAL_VULN_AUTO_APPROVE=true

# Development/Testing
ENABLE_SWAGGER_UI=true
ENABLE_REDOC=true
MOCK_SCANNER_APIS=false
MOCK_LLM_APIS=false
