"""
VulnZero API Gateway - Vulnerability Schemas
Pydantic models for vulnerability endpoints
"""

from typing import Optional, List
from datetime import datetime
from pydantic import BaseModel, Field


class VulnerabilityBase(BaseModel):
    """Base vulnerability schema"""
    cve_id: str = Field(..., description="CVE identifier")
    title: str = Field(..., description="Vulnerability title")
    severity: str = Field(..., description="Severity level")


class VulnerabilityCreate(VulnerabilityBase):
    """Schema for creating vulnerability"""
    pass


class VulnerabilityUpdate(BaseModel):
    """Schema for updating vulnerability"""
    status: Optional[str] = None
    assigned_to: Optional[str] = None


class VulnerabilityResponse(VulnerabilityBase):
    """Schema for vulnerability response"""
    id: int
    status: str
    cvss_score: Optional[float]
    priority_score: float
    discovered_at: datetime
    created_at: datetime

    class Config:
        from_attributes = True


class VulnerabilityList(BaseModel):
    """Schema for paginated vulnerability list"""
    items: List[VulnerabilityResponse]
    total: int
    page: int
    page_size: int
    total_pages: int
