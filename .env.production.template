# ============================================================================
# VulnZero - Production Environment Configuration
# ============================================================================
# IMPORTANT: Copy this file to .env.production and update all CHANGE_ME values
# NEVER commit .env.production to version control!
#
# Security Checklist:
# ✅ Replace all CHANGE_ME values
# ✅ Use strong, unique passwords (min 32 characters)
# ✅ Store secrets in a secure vault (AWS Secrets Manager, HashiCorp Vault, etc.)
# ✅ Enable HTTPS/TLS for all external connections
# ✅ Restrict database/redis access to localhost or VPN
# ✅ Configure firewall rules
# ✅ Enable audit logging
# ============================================================================

# ----------------------------------------------------------------------------
# Environment
# ----------------------------------------------------------------------------
ENVIRONMENT=production
VERSION=1.0.0
DATA_PATH=/var/lib/vulnzero

# ----------------------------------------------------------------------------
# Database Configuration
# ----------------------------------------------------------------------------
DATABASE_NAME=vulnzero_prod
DATABASE_USER=vulnzero_prod
DATABASE_PASSWORD=CHANGE_ME_USE_STRONG_RANDOM_PASSWORD_MIN_32_CHARS_$(openssl rand -hex 16)
DATABASE_HOST=postgres
DATABASE_PORT=5432
DATABASE_URL=postgresql+asyncpg://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}

# Database Connection Pool
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# ----------------------------------------------------------------------------
# Redis Configuration
# ----------------------------------------------------------------------------
REDIS_PASSWORD=CHANGE_ME_USE_STRONG_RANDOM_PASSWORD_MIN_32_CHARS_$(openssl rand -hex 16)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# ----------------------------------------------------------------------------
# Celery Configuration
# ----------------------------------------------------------------------------
CELERY_BROKER_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/1
CELERY_RESULT_BACKEND=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/2
CELERY_WORKER_CONCURRENCY=8
CELERY_TASK_TIME_LIMIT=3600
CELERY_TASK_SOFT_TIME_LIMIT=3300

# ----------------------------------------------------------------------------
# Authentication & Security
# ----------------------------------------------------------------------------
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=CHANGE_ME_IMMEDIATELY_USE_OPENSSL_RAND_HEX_32_$(openssl rand -hex 32)
API_SECRET_KEY=CHANGE_ME_IMMEDIATELY_USE_OPENSSL_RAND_HEX_32_$(openssl rand -hex 32)
API_ALGORITHM=HS256

# Token Expiration (in minutes/days)
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS Settings (comma-separated)
CORS_ORIGINS=https://vulnzero.example.com,https://app.vulnzero.example.com
CORS_ALLOW_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# ----------------------------------------------------------------------------
# LLM API Keys
# ----------------------------------------------------------------------------
OPENAI_API_KEY=CHANGE_ME_YOUR_OPENAI_API_KEY
ANTHROPIC_API_KEY=CHANGE_ME_YOUR_ANTHROPIC_API_KEY

# LLM Settings
DEFAULT_LLM_PROVIDER=openai
LLM_TIMEOUT=60
LLM_MAX_RETRIES=3
LLM_SANITIZATION_LEVEL=MODERATE

# ----------------------------------------------------------------------------
# External Integrations
# ----------------------------------------------------------------------------
# NVD (National Vulnerability Database)
NVD_API_KEY=CHANGE_ME_YOUR_NVD_API_KEY
NVD_API_URL=https://services.nvd.nist.gov/rest/json/cves/2.0

# Wazuh Integration
WAZUH_API_URL=CHANGE_ME_YOUR_WAZUH_API_URL
WAZUH_API_USERNAME=CHANGE_ME_YOUR_WAZUH_USERNAME
WAZUH_API_PASSWORD=CHANGE_ME_YOUR_WAZUH_PASSWORD

# Qualys Integration
QUALYS_API_URL=CHANGE_ME_YOUR_QUALYS_API_URL
QUALYS_USERNAME=CHANGE_ME_YOUR_QUALYS_USERNAME
QUALYS_PASSWORD=CHANGE_ME_YOUR_QUALYS_PASSWORD

# Tenable Integration
TENABLE_API_URL=https://cloud.tenable.com
TENABLE_ACCESS_KEY=CHANGE_ME_YOUR_TENABLE_ACCESS_KEY
TENABLE_SECRET_KEY=CHANGE_ME_YOUR_TENABLE_SECRET_KEY

# ----------------------------------------------------------------------------
# Monitoring & Observability
# ----------------------------------------------------------------------------
# Sentry (Error Tracking)
SENTRY_DSN=CHANGE_ME_YOUR_SENTRY_DSN
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus

# Grafana
GRAFANA_ADMIN_USER=vulnzero_admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_USE_STRONG_RANDOM_PASSWORD_MIN_32_CHARS_$(openssl rand -hex 16)
GRAFANA_SECRET_KEY=CHANGE_ME_USE_STRONG_RANDOM_PASSWORD_MIN_32_CHARS_$(openssl rand -hex 16)
GRAFANA_ROOT_URL=https://grafana.vulnzero.example.com

# PgAdmin
PGADMIN_EMAIL=admin@vulnzero.example.com
PGADMIN_PASSWORD=CHANGE_ME_USE_STRONG_RANDOM_PASSWORD_MIN_32_CHARS_$(openssl rand -hex 16)

# Flower (Celery Monitoring)
FLOWER_BASIC_AUTH=vulnzero_admin:CHANGE_ME_USE_STRONG_RANDOM_PASSWORD_MIN_32_CHARS
FLOWER_PORT=5555

# ----------------------------------------------------------------------------
# Application Settings
# ----------------------------------------------------------------------------
LOG_LEVEL=INFO
DEBUG=false
TESTING=false

# API Settings
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_MAX_REQUESTS=1000
API_MAX_REQUESTS_JITTER=100

# File Upload
MAX_UPLOAD_SIZE_MB=100
UPLOAD_DIR=/app/uploads

# Pagination
DEFAULT_PAGE_SIZE=50
MAX_PAGE_SIZE=100

# ----------------------------------------------------------------------------
# Deployment Settings
# ----------------------------------------------------------------------------
DEPLOYMENT_STRATEGY=canary
CANARY_PERCENTAGE=10
ROLLBACK_ON_ERROR=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3

# ----------------------------------------------------------------------------
# Backup Configuration
# ----------------------------------------------------------------------------
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=/backups

# S3 Backup Configuration (optional)
BACKUP_S3_ENABLED=false
BACKUP_S3_BUCKET=vulnzero-backups-prod
BACKUP_S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=CHANGE_ME_YOUR_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=CHANGE_ME_YOUR_AWS_SECRET_KEY

# ----------------------------------------------------------------------------
# Email Configuration
# ----------------------------------------------------------------------------
SMTP_ENABLED=true
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@vulnzero.example.com
SMTP_PASSWORD=CHANGE_ME_YOUR_SMTP_PASSWORD
SMTP_FROM_EMAIL=noreply@vulnzero.example.com
SMTP_FROM_NAME=VulnZero
SMTP_USE_TLS=true

# ----------------------------------------------------------------------------
# Alert Configuration
# ----------------------------------------------------------------------------
ALERT_EMAIL_ENABLED=true
ALERT_SLACK_ENABLED=false
ALERT_PAGERDUTY_ENABLED=false

SLACK_WEBHOOK_URL=CHANGE_ME_YOUR_SLACK_WEBHOOK_URL
PAGERDUTY_API_KEY=CHANGE_ME_YOUR_PAGERDUTY_API_KEY
PAGERDUTY_SERVICE_ID=CHANGE_ME_YOUR_PAGERDUTY_SERVICE_ID

# ----------------------------------------------------------------------------
# Feature Flags
# ----------------------------------------------------------------------------
FEATURE_AUTO_PATCH_ENABLED=false
FEATURE_AI_POWERED_PATCHING=true
FEATURE_MULTI_TENANCY=false
FEATURE_AUDIT_LOGGING=true
FEATURE_RATE_LIMITING=true

# ----------------------------------------------------------------------------
# Performance Tuning
# ----------------------------------------------------------------------------
# Worker Process Settings
WORKERS=4
WORKER_CLASS=uvicorn.workers.UvicornWorker
WORKER_CONNECTIONS=1000
WORKER_TIMEOUT=30
GRACEFUL_TIMEOUT=30
KEEP_ALIVE=5

# Cache Settings
CACHE_ENABLED=true
CACHE_TTL=300
CACHE_MAX_SIZE=1000

# ----------------------------------------------------------------------------
# SSL/TLS Configuration
# ----------------------------------------------------------------------------
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/vulnzero.crt
SSL_KEY_PATH=/etc/ssl/private/vulnzero.key
SSL_CA_CERT_PATH=/etc/ssl/certs/ca-bundle.crt

# ----------------------------------------------------------------------------
# Compliance & Audit
# ----------------------------------------------------------------------------
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=/var/log/vulnzero/audit.log
AUDIT_LOG_RETENTION_DAYS=365
PII_ENCRYPTION_ENABLED=true
GDPR_COMPLIANCE=true

# ----------------------------------------------------------------------------
# Custom Configuration
# ----------------------------------------------------------------------------
# Add any custom environment variables below
