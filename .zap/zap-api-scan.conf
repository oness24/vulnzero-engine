# OWASP ZAP API Scan Configuration
# API scan performs active attacks against API endpoints
# More comprehensive but slower than baseline scan
# Recommended for weekly/monthly security audits

# Alert Thresholds
# -----------------
# IGNORE: Ignore the alert completely
# WARN: Log as warning but don't fail the build
# FAIL: Fail the build if alert is found

# === OWASP API Security Top 10 (2023) ===

# API1:2023 - Broken Object Level Authorization
40039	FAIL

# API2:2023 - Broken Authentication
10105	FAIL

# API3:2023 - Broken Object Property Level Authorization
# (Mass Assignment vulnerabilities)
90034	FAIL

# API4:2023 - Unrestricted Resource Consumption
# (Rate limiting issues)
90027	WARN

# API5:2023 - Broken Function Level Authorization
40007	FAIL

# API6:2023 - Unrestricted Access to Sensitive Business Flows
# (Business logic flaws)
90030	WARN

# API7:2023 - Server Side Request Forgery
40046	FAIL

# API8:2023 - Security Misconfiguration
90019	WARN

# API9:2023 - Improper Inventory Management
# (Outdated API versions)
90028	WARN

# API10:2023 - Unsafe Consumption of APIs
# (Third-party API risks)
90029	WARN

# === Critical Vulnerabilities ===

# SQL Injection
10001	FAIL

# NoSQL Injection
40033	FAIL

# Command Injection
90020	FAIL

# LDAP Injection
40015	FAIL

# XPath Injection
40016	FAIL

# XML External Entity (XXE)
90023	FAIL

# Cross Site Scripting (XSS)
40012	FAIL
40014	FAIL
40016	FAIL

# Path Traversal
6	FAIL

# Remote File Inclusion
7	FAIL

# Local File Inclusion
40024	FAIL

# Server Side Include (SSI)
40009	FAIL

# Code Injection
90019	FAIL

# Expression Language Injection
90025	FAIL

# Server Side Template Injection (SSTI)
90035	FAIL

# === Authentication & Session Management ===

# Weak Authentication
10105	FAIL

# Session Fixation
40013	FAIL

# Insecure JWT Token
90024	FAIL

# Authentication Bypass
90001	FAIL

# Credentials Transmitted over Insecure Channel
10029	FAIL

# === Authorization ===

# Insufficient Authorization
90004	FAIL

# Privilege Escalation
90005	FAIL

# Insecure Direct Object References (IDOR)
90018	FAIL

# === Data Exposure ===

# Sensitive Data Exposure
10024	FAIL

# PII Disclosure
10025	FAIL

# Information Disclosure
10027	WARN

# Stack Trace Disclosure
10028	FAIL

# === Security Headers (API-specific) ===

# Missing Security Headers (we handle via middleware)
10020	IGNORE  # X-Frame-Options
10021	IGNORE  # X-Content-Type-Options
10038	IGNORE  # CSP
10035	IGNORE  # HSTS

# CORS Misconfiguration (IMPORTANT for API)
40040	FAIL

# === Rate Limiting & DoS ===

# Missing Rate Limiting
90027	WARN

# Application DoS
90026	WARN

# === Input Validation ===

# Buffer Overflow
30001	FAIL

# Format String Error
30002	FAIL

# Integer Overflow
30003	FAIL

# Parameter Tampering
40008	FAIL

# Insecure Deserialization
90021	FAIL

# === Configuration Issues ===

# Directory Browsing
90022	FAIL

# Debug Mode Enabled
10023	WARN

# Default Credentials
10012	FAIL

# === API-Specific Tests ===

# Missing Content-Type Header
10019	WARN

# HTTP Method Override
90032	WARN

# GraphQL Introspection Enabled (if using GraphQL)
90036	WARN

# === Scope Configuration ===

# Exclude health check endpoints from active scanning
/api/v1/system/health	OUTOFSCOPE

# Exclude documentation endpoints
/docs	OUTOFSCOPE
/redoc	OUTOFSCOPE
/openapi.json	OUTOFSCOPE

# Include all API endpoints for scanning
/api/v1/*	INSCOPE

# === Scan Policy ===

# Scan Policy: API-Default
# Attack Strength: MEDIUM
# Alert Threshold: MEDIUM
# Maximum Scan Duration: 60 minutes
